1 + 2
a = 1 + 2
b = a * 3
b
library(xlsx)
detach("package:xlsx", unload = TRUE)
setwd("E:/Project/R")
install.packages("tidyverse")
install.packages("caret")
install.packages("mlbench")
library(tidyverse)
library(caret)
library(mlbench)
df <- PimaIndianDiabetes2
df <- data("PimaIndianDiabetes2", package = "mlbench")
df <- data("PimaIndiansDiabetes2", package = "mlbench")
df <- PimaIndiansDiabetes2
View(PimaIndiansDiabetes2)
library(tidyverse)
library(caret)
library(mlbench)
df <- PimaIndiansDiabetes2
library(tidyverse)
library(caret)
library(mlbench)
df <- PimaIndiansDiabetes2
data("PimaIndiansDiabetes2", package = "mlbench")
df <- PimaIndiansDiabetes2
# load
data("PimaIndiansDiabetes2", package = "mlbench")
df <- PimaIndiansDiabetes2
# Clear NA's data
df <- na.omit(df)
summary(df)
# Check dataframe
class(df)
# Memisahkan data training dan data set
set.seed(40)
df.sample <- df$diabetes %>% createDataPartition(p = 0.8, list = F)
data.train <- df[df.sample, ]
data.test <- df[-df.sample, ]
# Membuat model
model <- glm( diabetes ~., data = data.train, family = binomial())
View(model)
summary(model)
# Membuat prediksi
probalitas <- model %>% predict(data.test, type = "response")
# Membuat prediksi
probabilitas <- model %>% predict(data.test, type = "response")
prediksi.class <- ifelse(proba)
prediksi.class <- ifelse(probabilitas> 0.5, "pos", "neg")
# Akurasi Model
mean(prediksi.class == data.test$diabetes)
# plot
data.train %>%
mutate(probabilitas = ifelse(diabetes == "pos", 1,0)) %>%
ggplot(aes(glucose, prob)) +
geom_point(aplha = 0.2) +
geom_smooth(method = "glm", method.args = list(family = "binomial")) +
labs(
title = "Model Regresi Logistik",
x = "Konsentrasi Glukosa Plasma",
y = "Probabilitas positif diabetes"
)
d
# plot
data.train %>%
mutate(probabilitas = ifelse(diabetes == "pos", 1,0)) %>%
ggplot(aes(glucose, probabilitas)) +
geom_point(aplha = 0.2) +
geom_smooth(method = "glm", method.args = list(family = "binomial")) +
labs(
title = "Model Regresi Logistik",
x = "Konsentrasi Glukosa Plasma",
y = "Probabilitas positif diabetes"
)
theme_set(theme_bw())
# plot
data.train %>%
mutate(probabilitas = ifelse(diabetes == "pos", 1,0)) %>%
ggplot(aes(glucose, probabilitas)) +
geom_point(aplha = 0.2) +
geom_smooth(method = "glm", method.args = list(family = "binomial")) +
labs(
title = "Model Regresi Logistik",
x = "Konsentrasi Glukosa Plasma",
y = "Probabilitas positif diabetes"
)
summary(model)$coef
model <- glm( diabetes ~ glucose, data = train.data, family = binomial)
View(df)
